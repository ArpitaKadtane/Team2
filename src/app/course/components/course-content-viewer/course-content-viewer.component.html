<div class="course-viewer">
  <!-- Sidebar for Modules -->
  <div class="sidebar">
    <h3>Modules</h3>
    <ul>
      <li
        *ngFor="let module of course?.modules; let i = index"
        [class.active]="i === currentModuleIndex"
        (click)="selectModule(i)"
      >
        {{ module.name }} <span *ngIf="module.completed">‚úîÔ∏è</span>
      </li>
    </ul>
  </div>

  <!-- Main Content Area -->
  <div class="content">
    <h2>{{ course?.modules[currentModuleIndex]?.name }}</h2>

    <!-- Video Content -->
    <ng-container *ngIf="course?.modules[currentModuleIndex]?.type === 'video'">
      <video controls width="100%" height="500px">
        <source [src]="safeVideoUrl" type="video/mp4" />
      </video>
    </ng-container>

    <!-- PDF Content -->
    <ng-container *ngIf="course?.modules[currentModuleIndex]?.type === 'pdf'">
      <iframe [src]="safePdfUrl" width="100%" height="100vh"></iframe>
    </ng-container>

    <!-- Progress Bar -->
    <div class="progress-container">
      <label>Course Progress: {{ progress }}%</label>
      <div class="progress-bar">
        <div class="progress-fill" [style.width.%]="progress"></div>
      </div>
    </div>

    <!-- Mark as Completed Button -->
    <button
      *ngIf="!course?.modules[currentModuleIndex]?.completed"
      class="complete-btn"
      (click)="markAsCompleted()"
    >
      Mark as Completed
    </button>

    <!-- Navigation Buttons -->
    <div class="actions">
      <button (click)="previousModule()" [disabled]="currentModuleIndex === 0">
        Previous
      </button>
      <button (click)="nextModule()">Next</button>
    </div>

    <!-- Feedback Section -->
    <div *ngIf="showFeedbackForm" class="feedback-container">
      <h3>Provide Your Feedback</h3>

      <label>Course Rating:</label>
      <div class="star-rating">
        <span *ngFor="let star of [1, 2, 3, 4, 5]; let i = index"
              (click)="setCourseRating(i + 1)"
              [class.filled]="i < courseRating">
          ‚òÖ
        </span>
      </div>

      <label>Instructor Rating:</label>
      <div class="star-rating">
        <span *ngFor="let star of [1, 2, 3, 4, 5]; let i = index"
              (click)="setInstructorRating(i + 1)"
              [class.filled]="i < instructorRating">
          ‚òÖ
        </span>
      </div>

      <textarea [(ngModel)]="feedbackText" placeholder="Your feedback..."></textarea>

      <button (click)="submitFeedback()">Submit Feedback</button>
    </div>

    <!-- Feedback Success Message -->
    <div *ngIf="feedbackSubmitted" class="feedback-success">
      <p>Feedback submitted successfully! üéâ</p>
      <p>Wait for the certificate to get generated...</p>
    </div>
  </div>
</div>
